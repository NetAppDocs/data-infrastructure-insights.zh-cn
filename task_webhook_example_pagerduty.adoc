---
sidebar: sidebar 
permalink: task_webhook_example_pagerduty.html 
keywords: webhook, notification, PagerDuty, integration 
summary: 创建 Webhook 来针对 Pagerduty 的性能或库存阈值发出警报 
---
= PagerDuty 的 Webhook 示例
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Webhook 允许用户使用自定义的 webhook 通道向各种应用程序发送警报通知。本页面提供了为 PagerDuty 设置 webhook 的示例。


NOTE: 本页引用第三方说明，可能会有所变更。请参阅link:https://support.pagerduty.com/docs/services-and-integrations["PagerDuty 文档"]以获取最新信息。



== PagerDuty 设置：

. 在 PagerDuty 中，导航至 *服务 > 服务目录*，然后单击 *+新服务* 按钮
. 输入_名称_并选择_直接使用我们的 API_。点击_添加服务_。
+
image:Webhooks_PagerDutyScreen1.png["Pagerduty 屏幕"]

. 单击“Integrations”选项卡即可查看“Integration Key”。当您创建下面的Data Infrastructure Insightswebhook 时，您将需要此密钥。


. 前往*事件*或*服务*查看警报。
+
image:Webhooks_PagerDutyScreen2.png["Pagerduty 屏幕"]





== 创建Data Infrastructure InsightsWebhook：

. 在Data Infrastructure Insights中，导航到 *管理 > 通知* 并选择 *Webhooks* 选项卡。单击 *+Webhook* 创建一个新 webhook。
. 为 webhook 赋予一个有意义的名称，例如“PagerDuty Trigger”。您将使用此 webhook 来处理严重和警告级别的事件。
. 在“模板类型”下拉菜单中，选择“PagerDuty”。


. 创建一个名为 _routingKey_ 的自定义参数机密，并将其值设置为上面的 PagerDuty _Integration Key_ 值。
+
image:Webhooks_Custom_Secret_Routing_Key.png["设置路由键"]



重复这些步骤，为已解决的事件创建“PagerDuty Resolve”webhook。



== PagerDutyData Infrastructure Insights字段映射

下表和图片显示了 PagerDuty 和Data Infrastructure Insights之间的字段映射：

[cols="<,<"]
|===
| PagerDuty | Data Infrastructure Insights 


| 警报键 | Alert ID 


| 源 | 触发于 


| 组件 | 指标名称 


| 组 | 对象类型 


| 班级 | 监视器名称 
|===
image:Webhooks-PagerDuty_Fields.png["CI 中的 PagerDuty 字段"]



== 通过 Webhook 发送通知

要通过 webhook 通知事件，请在Data Infrastructure Insights中导航至 *Alerts > Monitors*，然后单击 *+Monitor* 以创建新的link:task_create_monitor.html["监视器"]。

* 选择一个指标并定义监视器的条件。
* 在“设置团队通知”下，选择“Webhook”传送方式。
* 为严重和警告级别事件选择“PagerDuty Trigger”webhook。
* 为已解决的事件选择“PagerDuty Resolve”。
+
image:Webhooks_Notifications.png["Webhook 通知"]




NOTE: 为触发事件和已解决事件设置单独的通知是最佳做法，因为 PagerDuty 处理触发事件的方式与处理已解决事件的方式不同。
