---
sidebar: sidebar 
permalink: concept_dashboard_features.html 
summary: 仪表板功能和概念。 
keywords: dashboard, widget, custom, concepts, queries, variables, rollup, roll up, grouping, aggregate, aggregation, filter, axis, group by, expressions, timeseries, exact match, theme, visibility, formatting, conditional, hide, collapse, expand 
---
= 仪表板功能
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
仪表板和小部件为数据的显示方式提供了极大的灵活性。以下概念可帮助您充分利用自定义仪表板。

目录：[]



== 小部件命名

小部件会根据为第一个小部件查询选择的对象、指标或属性自动命名。如果您还为小部件选择了分组，则“分组依据”属性将包含在自动命名（聚合方法和指标）中。

image:WidgetNamingExample-C.png["小部件命名示例"]

选择新的对象或分组属性会更新自动名称。

如果您不想使用自动小部件名称，您可以简单地输入一个新名称。



== 小部件的位置和大小

所有仪表板小部件都可以根据每个特定仪表板的需求进行定位和调整大小。



== 复制小部件

在仪表板编辑模式下，单击小部件上的菜单并选择*复制*。小部件编辑器启动，预先填充原始小部件的配置，并在小部件名称中带有“复制”后缀。您可以轻松进行任何必要的更改并保存新的小部件。该小部件将被放置在仪表板的底部，您可以根据需要定位它。当所有更改完成后，请记住保存您的仪表板。



== 显示小部件图例

仪表板上的大多数小部件都可以显示或不显示图例。可以通过以下任一方法在仪表板上打开或关闭小部件中的图例：

* 显示仪表板时，单击小部件上的“*选项*”按钮，然后在菜单中选择“*显示图例*”。


随着小部件中显示的数据发生变化，该小部件的图例也会动态更新。

当显示图例时，如果可以导航到图例指示的资产的登录页面，则图例将显示为指向该资产页面的链接。如果图例显示“全部”，单击链接将显示与小部件中第一个查询对应的查询页面。



== 转换指标

Data Infrastructure Insights为小部件中的某些指标（具体来说，那些称为“自定义”或集成指标的指标，例如来自 Kubernetes、 ONTAP高级数据、Telegraf 插件等）提供了不同的*转换*选项，允许您以多种方式显示数据。将可转换指标添加到小部件时，您将看到一个下拉菜单，其中提供以下转换选项：

无：数据按原样显示，不进行任何处理。

速率：当前值除以自上次观察以来的时间范围。

累积：先前值与当前值之和的累积。

Delta：前一个观测值与当前值之间的差值。

增量率：增量值除以自上次观察以来的时间范围。

累积率：累积值除以自上次观察以来的时间范围。

请注意，转换指标不会改变底层数据本身，而只会改变数据的显示方式。



== 仪表板小部件查询和过滤器



=== 查询

仪表板小部件中的查询是管理数据显示的强大工具。以下是有关小部件查询的一些注意事项。

某些小部件最多可以有五个查询。每个查询都会在小部件中绘制自己的一组线条或图形。在一个查询上设置汇总、分组、顶部/底部结果等不会影响小部件的任何其他查询。

您可以单击眼睛图标暂时隐藏查询。当您隐藏或显示查询时，小部件显示会自动更新。这使您可以在构建小部件时检查显示的数据是否包含单个查询。

以下小部件类型可以有多个查询：

* 面积图
* 堆积面积图
* 折线图
* 样条图
* 单值小部件


其余的小部件类型只能有一个查询：

* 表
* 条形图
* 箱线图
* 散点图




=== 在仪表板小部件查询中进行过滤

您可以采取以下措施来充分利用过滤器。



==== 精确匹配过滤

如果将过滤字符串括在双引号中，Insight 会将第一个引号和最后一个引号之间的所有内容视为完全匹配。引号内的任何特殊字符或运算符都将被视为文字。例如，过滤“*”将返回文字星号的结果；在这种情况下，星号不会被视为通配符。当运算符 AND、OR 和 NOT 括在双引号中时，它们也将被视为文字字符串。

您可以使用精确匹配过滤器来查找特定资源，例如主机名。如果您只想查找主机名“marketing”，但排除“marketing01”、“marketing-boston”等，只需将名称“marketing”括在双引号中。



==== 通配符和表达式

当您在查询或仪表板小部件中过滤文本或列表值时，当您开始输入时，系统会向您显示基于当前文本创建*通配符过滤器*的选项。选择此选项将返回与通配符表达式匹配的所有结果。您还可以使用 NOT 或 OR 创建*表达式*，或者您可以选择“无”选项来过滤字段中的空值。

image:Type-Ahead-Example-ingest.png["通配符过滤器"]

基于通配符或表达式的过滤器（例如 NOT、OR、“无”等）在过滤器字段中以深蓝色显示。您直接从列表中选择的项目显示为浅蓝色。

image:Type-Ahead-Example-Wildcard-DirectSelect.png["通配符过滤结果"]

请注意，通配符和表达式过滤适用于文本或列表，但不适用于数字、日期或布尔值。



==== 具有上下文预先输入建议的高级文本过滤

小部件查询中的过滤是_上下文_的；当您为某个字段选择一个或多个过滤值时，该查询的其他过滤器将显示与该过滤器相关的值。例如，当为特定对象_Name_设置过滤器时，用于过滤_Model_的字段将仅显示与该对象名称相关的值。

上下文过滤也适用于仪表板页面变量（仅限文本类型属性或注释）。当您为一个变量选择一个过滤器值时，任何其他使用相关对象的变量将仅根据这些相关变量的上下文显示可能的过滤值。

请注意，只有文本过滤器才会显示上下文预先输入建议。日期、枚举（列表）等不会显示预先输入建议。也就是说，您可以在枚举（即列表）字段上设置过滤器，并在上下文中过滤其他文本字段。例如，在“数据中心”等枚举字段中选择一个值，则其他过滤器将仅显示该数据中心中的模型/名称），但反之则不然。

所选的时间范围还将为过滤器中显示的数据提供背景。



==== 选择过滤单元

当您在过滤器字段中输入值时，您可以选择在图表上显示该值的单位。例如，您可以根据原始容量进行过滤并选择以默认的 GiB 显示，或者选择其他格式（如 TiB）。如果您的仪表板上有多个图表以 TiB 为单位显示值，并且您希望所有图表都显示一致的值，这将非常有用。

image:Filter_Unit_Format.png["在过滤器中选择单位"]



==== 额外的过滤改进

以下内容可用于进一步优化您的过滤器。

* 使用星号可以搜索所有内容。例如，
+
[listing]
----
vol*rhel
----
+
显示以“vol”开头并以“rhel”结尾的所有资源。

* 使用问号可以搜索特定数量的字符。例如，
+
[listing]
----
BOS-PRD??-S12
----
+
显示 _BOS-PRD12-S12_、_BOS-PRD13-S12_ 等等。

* OR 运算符使您能够指定多个实体。例如，
+
[listing]
----
FAS2240 OR CX600 OR FAS3270
----
+
找到多个存储模型。

* NOT 运算符允许您从搜索结果中排除文本。例如，
+
[listing]
----
NOT EMC*
----
+
查找所有不以“EMC”开头的内容。您可以使用

+
[listing]
----
NOT *
----
+
显示不包含任何值的字段。





=== 识别查询和过滤器返回的对象

查询和过滤器返回的对象与下图所示的对象类似。分配有“标签”的对象是注释，而没有标签的对象是性能计数器或对象属性。

image:ObjectsReturnedByFilters.png["过滤器返回的对象"]



== 分组和聚合



=== 分组（汇总）

小部件中显示的数据是根据采集期间收集的底层数据点分组（有时称为汇总）的。例如，如果您有一个显示随时间变化的存储 IOPS 的折线图小部件，您可能希望看到每个数据中心的单独线条，以便快速比较。您可以选择通过以下几种方式之一对这些数据进行分组：

* *平均值*：将每一行显示为基础数据的平均值。
* *最大值*：将每一行显示为基础数据的_最大值_。
* *最小值*：将每一行显示为基础数据的_最小值_。
* *总和*：将每一行显示为基础数据的总和。
* *计数*：显示在指定时间范围内报告数据的对象的数量。您可以选择由仪表板时间范围确定的_整个时间窗口_。


.步骤
要设置分组方法，请执行以下操作。

. 在小部件的查询中，选择资产类型和指标（例如，_存储_）和指标（例如_性能 IOPS 总计_）。
. 对于*组*，选择一种汇总方法（例如_平均值_），并选择用于汇总数据的属性或指标（例如，_数据中心_）。
+
该小部件会自动更新并显示每个数据中心的数据。



您还可以选择将所有基础数据分组到图表或表格中。在这种情况下，您将在小部件中获得每个查询的一行，它将显示所有基础资产的所选指标的平均值、最小值、最大值、总和或计数。

单击任何按“全部”分组数据的小部件的图例，将打开一个查询页面，显示小部件中使用的第一个查询的结果。

如果您为查询设置了过滤器，则数据将根据过滤后的数据进行分组。

请注意，当您选择按任何字段（例如，_Model_）对小部件进行分组时，您仍然需要按该字段进行过滤，以便在图表或表格上正确显示该字段的数据。



=== 聚合数据

您可以通过将数据点聚合到分钟、小时或天的存储桶中来进一步调整时间序列图表（线、区域等），然后按属性汇总数据（如果选择）。您可以选择根据数据点的“平均值”、“最大值”、“最小值”、“总和”或“计数”来聚合数据点。

较小的间隔与较长的时间范围相结合可能会导致“聚合间隔导致数据点过多。”警告。如果您的间隔较小并且将仪表板时间范围增加到 7 天，您可能会看到这种情况。在这种情况下，Insight 将暂时增加聚合间隔，直到您选择较小的时间范围。

您还可以在条形图小部件和单值小部件中聚合数据。

大多数资产计数器默认聚合为_平均值_。某些计数器默认聚合为_Max、Min_或_Sum_。例如，端口错误默认聚合为_Sum_，而存储 IOPS 聚合为_Average_。



== 显示顶部/底部结果

在图表小部件中，您可以显示汇总数据的*顶部*或*底部*结果，并从提供的下拉列表中选择显示的结果数。在表格小部件中，您可以按任意列进行排序。



=== 图表小部件顶部/底部

在图表小部件中，当您选择按特定属性汇总数据时，您可以选择查看前 N 个或后 N 个结果。请注意，当您选择按所有属性汇总时，您无法选择顶部或底部结果。

您可以通过在查询的 *显示* 字段中选择 *顶部* 或 *底部*，然后从提供的列表中选择一个值来选择要显示的结果。



=== 表格小部件显示条目

在表格小部件中，您可以选择表格结果中显示的结果数。您无法选择顶部或底部结果，因为表格允许您根据需要按任意列升序或降序排序。

您可以通过从查询的*显示条目*字段中选择一个值来选择仪表板上的表格中显示的结果数。



== 表格小部件中的分组

表格小部件中的数据可以按任何可用属性进行分组，使您能够查看数据概览，并深入了解更多详细信息。表格中的指标被汇总到每个折叠行中，以便于查看。

表格小部件允许您根据设置的属性对数据进行分组。例如，您可能希望表格显示按存储所在的数据中心分组的总存储 IOPS。或者您可能想要显示根据托管虚拟机的虚拟机管理程序分组的虚拟机表。从列表中，您可以展开每个组来查看该组中的资产。

分组仅在表格小部件类型中可用。



=== 分组示例（包含汇总说明）

表格小部件允许您对数据进行分组以便于显示。

在此示例中，我们将创建一个表格小部件，显示按数据中心分组的所有虚拟机。

.步骤
. 创建或打开仪表板，并添加*表格*小部件。
. 选择“虚拟机”作为此小部件的资产类型。
. 单击列选择器并选择_Hypervisor name_ 和 _IOPS - Total_。
+
这些列现在显示在表中。

. 让我们忽略任何没有 IOPS 的虚拟机，只包括总 IOPS 大于 1 的虚拟机。单击“Filter by”*[+]*按钮并选择“IOPS - Total”。单击“任何”，然后在“来自”字段中输入“1”。将“*to*”字段留空。按 Enter 键或单击过滤器字段以应用过滤器。
+
该表现在显示总 IOPS 大于或等于 1 的所有虚拟机。请注意，表中没有分组。显示所有虚拟机。

. 单击“按 [+] 分组”*按钮。
+
您可以按显示的任何属性或注释进行分组。选择“全部”可显示单个组中的所有虚拟机。

+
任何性能指标的列标题都会显示一个包含*向上滚动*选项的“三点”菜单。默认的汇总方法是_平均_。这意味着该组显示的数字是组内每个虚拟机报告的所有总 IOPS 的平均值。您可以选择按“平均值”、“总和”、“最小值”或“最大值”来汇总此列。您显示的任何包含绩效指标的列都可以单独汇总。

+
image:TableRollUp.png["卷起"]

. 单击“全部”并选择“虚拟机管理程序名称”。
+
VM 列表现在按 Hypervisor 分组。您可以展开每个虚拟机管理程序来查看其托管的虚拟机。

. 单击“*保存*”将表保存到仪表板。您可以根据需要调整小部件的大小或移动它。
. 单击“*保存*”以保存仪表板。




=== 绩效数据汇总

如果您在表格小部件中包含性能数据列（例如，_IOPS - Total_），则当您选择对数据进行分组时，您可以选择该列的汇总方法。默认的汇总方法是显示组行中基础数据的平均值（_avg_）。您还可以选择显示数据的总和、最小值或最大值。



== 仪表板时间范围选择器

您可以选择仪表板数据的时间范围。只有与所选时间范围相关的数据才会显示在仪表板的小部件中。您可以从以下时间范围中进行选择：

* 最后15分钟
* 最后30分钟
* 最后60分钟
* 过去 2 小时
* 最近 3 小时（这是默认值）
* 过去 6 小时
* 过去 12 小时
* 过去 24 小时
* 过去 2 天
* 过去 3 天
* 过去 7 天
* 过去 30 天
* 自定义时间范围
+
自定义时间范围允许您选择最多连续 31 天。您还可以设置此范围的开始时间和结束时间。默认开始时间为所选第一天的凌晨 12:00，默认结束时间为所选最后一天的晚上 11:59。单击“*应用*”将把自定义时间范围应用到仪表板。





=== 放大到某个时间范围

在查看时间序列小部件（线、样条线、面积、堆积面积）或登录页面上的图表时，您可以将鼠标拖到图表上进行放大。然后，您可以在屏幕的右上角锁定该时间范围，以便其他页面上的图表反映该锁定时间范围内的数据。要解锁，请从列表中选择不同的时间范围。



== 覆盖单个小部件中的仪表板时间

您可以在单个小部件中覆盖主仪表板时间范围设置。这些小部件将根据其设定的时间范围而不是仪表板的时间范围显示数据。

要覆盖仪表板时间并强制小部件使用其自己的时间范围，请在小部件的编辑模式下选择所需的时间范围，然后将小部件保存到仪表板。

无论您在仪表板上选择的时间范围是什么，小部件都会根据为其设置的时间范围显示其数据。

您为一个小部件设置的时间范围不会影响仪表板上的任何其他小部件。

image:OverrideTimeOnWidget.png["覆盖小部件的仪表板时间范围"]



== 主轴和次轴

不同的指标使用不同的测量单位来表示图表中报告的数据。例如，在查看 IOPS 时，测量单位是每秒的 I/O 操作数（IO/s），而延迟纯粹是时间的度量（毫秒、微秒、秒等）。当使用一组 Y 轴值在单个折线图上绘制这两个指标时，延迟数（通常为几毫秒）与 IOPS（通常以千为单位）以相同的比例绘制，并且延迟线在该比例下会丢失。

但是，通过在主（左侧） Y 轴上设置一个测量单位，在次（右侧） Y 轴上设置另一个测量单位，可以在一个有意义的图表上绘制这两组数据。每个指标都按照其自己的比例绘制。

.步骤
此示例说明了图表小部件中主轴和次轴的概念。

. 创建或打开仪表板。向仪表板添加折线图、样条图、面积图或堆积面积图小部件。
. 选择一种资产类型（例如“存储”），然后选择“IOPS - 总计”作为您的第一个指标。设置您喜欢的任何过滤器，并根据需要选择汇总方法。
+
图表上显示 IOPS 线，其比例显示在左侧。

. 单击*[+查询]*向图表添加第二条线。对于此行，选择“延迟 - 总计”作为指标。
+
请注意，该线在图表底部显示为平面。这是因为它是以与 IOPS 线相同的比例绘制的。

. 在延迟查询中，选择*Y 轴：次要*。
+
延迟线现在按照其自己的比例绘制，显示在图表的右侧。



image:SecondaryAxisExplained.png["次坐标轴示例"]



== 小部件中的表达式

在仪表板中，任何时间序列小部件（线、样条线、区域、堆叠区域）、条形图、柱形图、饼图或表格小部件都允许您根据所选指标构建表达式，并在单个图表（或列）中显示这些表达式的结果<<expressions-in-a-table-widget,表格小部件>>）。下面的例子使用表达式来解决具体问题。在第一个示例中，我们希望显示读取 IOPS 占租户上所有存储资产的总 IOPS 的百分比。第二个示例可以让您了解租户上发生的“系统”或“开销” IOPS——那些不是直接来自读取或写入数据的 IOPS。

您可以在表达式中使用变量（例如，_$Var1 * 100_）



=== 表达式示例：读取 IOPS 百分比

在此示例中，我们希望显示读取 IOPS 占总 IOPS 的百分比。您可以将其视为以下公式：

 Read Percentage = (Read IOPS / Total IOPS) x 100
该数据可以以折线图的形式显示在您的仪表板上。为此，请按照下列步骤操作：

.步骤
. 创建新的仪表板，或以编辑模式打开现有仪表板。
. 向仪表板添加一个小部件。选择*面积图*。
+
该小部件以编辑模式打开。默认情况下，会显示一个查询，其中显示“存储”资产的“IOPS - 总计”。如果需要，请选择不同的资产类型。

. 单击右侧的*转换为表达式*链接。
+
当前查询转换为表达式模式。请注意，在表达模式下您无法更改资产类型。当您处于表达模式时，链接将更改为*恢复查询*。如果您希望随时切换回查询模式，请单击此按钮。请注意，在模式之间切换会将字段重置为默认值。

+
现在，保持表达模式。

. *IOPS - Total* 指标现在位于字母变量字段“*a*”中。在“*b*”变量字段中，单击*选择*并选择*IOPS - 读取*。
+
您可以通过单击变量字段后面的 + 按钮，为表达式添加最多五个字母变量。对于我们的读取百分比示例，我们只需要总 IOPS（“*a*”）和读取 IOPS（“*b*”）。

. 在“*表达式*”字段中，您可以使用与每个变量对应的字母来构建表达式。我们知道读取百分比 = (读取 IOPS / 总 IOPS) x 100，因此我们可以将此表达式写为：
+
 (b / a) * 100
. *标签* 字段标识表达式。将标签更改为“阅读百分比”，或对您来说同样有意义的内容。
. 将*单位*字段更改为“％”或“百分比”。
+
该图表显示所选存储设备随时间变化的 IOPS 读取百分比。如果需要，您可以设置过滤器，或选择不同的汇总方法。请注意，如果您选择“总和”作为汇总方法，则所有百分比值都会加在一起，其值可能会高于 100%。

. 单击“*保存*”将图表保存到您的仪表板。




=== 表达式示例：“系统” I/O

示例 2：从数据源收集的指标包括读取、写入和总 IOPS。但是，数据源报告的 IOPS 总数有时包括“系统”IOPS，即那些不直接属于数据读取或写入的 IO 操作。该系统 I/O 也可以被认为是“开销” I/O，对于正常的系统操作是必需的，但与数据操作没有直接关系。

为了显示这些系统 I/O，您可以从采集报告的总 IOPS 中减去读取和写入 IOPS。该公式可能如下所示：

 System IOPS = Total IOPS - (Read IOPS + Write IOPS)
然后，这些数据可以在仪表板上以折线图的形式显示。为此，请按照下列步骤操作：

.步骤
. 创建新的仪表板，或以编辑模式打开现有仪表板。
. 向仪表板添加一个小部件。选择*折线图*。
+
该小部件以编辑模式打开。默认情况下，会显示一个查询，其中显示“存储”资产的“IOPS - 总计”。如果需要，请选择不同的资产类型。

. 在“*汇总*”字段中，选择“按_全部_求和”。
+
图表显示一条线，表示总 IOPS 的总和。

. 单击“复制此查询”图标来创建查询的副本。
+
查询的副本被添加到原始查询的下方。

. 在第二个查询中，单击“转换为表达式”按钮。
+
当前查询转换为表达式模式。如果您希望随时切换回查询模式，请单击“*恢复查询*”。请注意，在模式之间切换会将字段重置为其默认值。

+
现在，保持表达模式。

. _IOPS - Total_ 指标现在位于字母变量字段“*a*”中。单击“_IOPS - Total_”并将其更改为“_IOPS - Read_”。
. 在“*b*”变量字段中，单击*选择*并选择_IOPS - 写入_。
. 在“*表达式*”字段中，您可以使用与每个变量对应的字母来构建表达式。我们将表达式简单地写为：
+
 a + b
+
在显示部分，为此表达式选择*面积图*。

. *标签* 字段标识表达式。将标签更改为“系统 IOPS”，或对您来说同样有意义的标签。
+
该图表以折线图的形式显示总 IOPS，下方的区域图显示读取和写入 IOPS 的组合。两者之间的差距体现的是与数据读取或写入操作没有直接关系的IOPS。这些是您的“系统”IOPS。

. 单击“*保存*”将图表保存到您的仪表板。


要在表达式中使用变量，只需键入变量名称，例如 _$var1 * 100_。表达式中只能使用数字变量。



=== 表格小部件中的表达式

表格小部件处理表达式的方式略有不同。单个表格小部件中最多可以有五个表达式，每个表达式都作为新列添加到表格中。每个表达式最多可以包含五个要执行计算的值。您可以轻松地为该列命名一个有意义的名称。

image:ExpressionExample.png["表格小部件中的表达式"]



== 变量

变量允许您一次更改仪表板上部分或全部小部件中显示的数据。通过设置一个或多个小部件使用一个公共变量，在一个地方所做的更改会导致每个小部件中显示的数据自动更新。



=== 变量类型

变量可以是以下类型之一：

* *属性*：使用对象的属性或指标进行过滤
* *注释*：使用预定义的link:task_defining_annotations.html["标注"]过滤小部件数据。
* *文本*：字母数字字符串。
* *数字*：一个数字值。根据您的小部件字段，可以单独使用，也可以将其作为“从”或“到”值。
* *布尔值*：用于值为 True/False、Yes/No 等的字段。对于布尔变量，选择有 Yes、No、None、Any。
* *日期*：日期值。根据您的小部件的配置，用作“从”或“到”值。


image:Variables_Drop_Down_Showing_Annotations.png["变量类型"]



==== 属性变量

选择属性类型变量允许您过滤包含指定属性值的小部件数据。下面的示例显示了一个线形小部件，其中显示了代理节点的可用内存趋势。我们为代理节点 IP 创建了一个变量，当前设置为显示所有 IP：

image:Variables_Node_Example_Before_Variable_Applied.png["变量过滤器之前的代理节点"]

但是，如果您暂时只想查看租户上各个子网上的节点，则可以将变量设置或更改为特定的代理节点 IP 或 IP。这里我们只查看“123”子网上的节点：

image:Variables_Node_Example_After_Variable_Applied.png["变量过滤器后的代理节点"]

您还可以设置一个变量来过滤具有特定属性的所有对象，而不管对象类型如何，例如具有“vendor”属性的对象，方法是在变量字段中指定 _*.vendor_。您不需要输入“*。”；如果您选择通配符选项， Data Infrastructure Insights将提供此信息。

image:Variables_Attribute_Vendor_Example.png["供应商的属性变量"]

当您下拉变量值的选项列表时，结果会被过滤，因此仅显示基于仪表板上的对象的可用供应商。

image:Variables_Attribute_Vendor_Filtered_List.png["属性变量仅显示可用的供应商"]

如果您在仪表板上编辑与属性过滤器相关的窗口小部件（即窗口小部件的对象包含任何 _*.vendor 属性_），它会显示属性过滤器已自动应用。

image:Variables_Attribute_inWidgetQuery.png["自动应用属性变量"]

应用变量就像更改您选择的属性数据一样简单。



==== 注释变量

选择注释变量允许您过滤与该注释关联的对象，例如属于同一数据中心的对象。

image:Variables_Annotation_Filtering.png["使用变量进行注释过滤"]



==== 文本、数字、日期或布尔变量

您可以通过选择变量类型“_Text_”、“_Number_”、“_Boolean_”或“_Date_”来创建与特定属性无关的通用变量。一旦创建了变量，您就可以在小部件过滤器字段中选择它。在小部件中设置过滤器时，除了可以为过滤器选择的特定值之外，为仪表板创建的任何变量都会显示在列表中 - 这些变量分组在下拉菜单中的“变量”部分下，名称以“$”开头。在此过滤器中选择一个变量将允许您搜索在仪表板本身的变量字段中输入的值。任何在过滤器中使用该变量的小部件都将动态更新。

image:Variables_in_a_Widget_Filter.png["在小部件中选择变量"]



==== 变量过滤范围

当您向仪表板添加注释或属性变量时，该变量可以应用于仪表板上的所有小部件，这意味着仪表板上的所有小部件都将显示根据您在变量中设置的值过滤的结果。

image:Variables_Automatic_Filter_Button.png["自动过滤器"]

请注意，只有属性和注释变量可以像这样自动过滤。非注释或属性变量无法自动过滤。必须将各个小部件分别配置为使用这些类型的变量。

要禁用自动过滤，以便变量仅适用于您专门设置的小部件，请单击“自动过滤”滑块将其禁用。

要在单个小部件中设置变量，请在编辑模式下打开该小部件，然后在“Filter By”字段中选择特定的注释或属性。使用注释变量，您可以选择一个或多个特定值，或者选择变量名称（以前导“$”表示）以允许在仪表板级别输入变量。这同样适用于属性变量。只有您设置了变量的小部件才会显示过滤结果。

变量中的过滤是_上下文_的；当您为变量选择一个或多个过滤值时，页面上的其他变量将仅显示与该过滤器相关的值。例如，当将变量过滤器设置为特定存储_Model_时，设置为存储_Name_过滤的任何变量将仅显示与该模型相关的值。

要在表达式中使用变量，只需键入变量名称作为表达式的一部分，例如，_$var1 * 100_。表达式中只能使用数字变量。您不能在表达式中使用数字注释或属性变量。

变量中的过滤是_上下文_的；当您为变量选择一个或多个过滤值时，页面上的其他变量将仅显示与该过滤器相关的值。例如，当将变量过滤器设置为特定存储_Model_时，设置为存储_Name_过滤的任何变量将仅显示与该模型相关的值。



==== 变量命名

变量名称：

* 必须仅包含字母 az、数字 0-9、句点 (.)、下划线 (_) 和空格 ( )。
* 不能超过 20 个字符。
* 区分大小写：$CityName 和 $cityname 是不同的变量。
* 不能与现有的变量名相同。
* 不能为空。




== 格式化仪表小部件

实体和子弹量规小部件允许您设置_警告_和/或_临界_级别的阈值，从而清晰地表示您指定的数据。

image:GaugeWidgetFormatting.png["仪表小部件的格式设置"]

要设置这些小部件的格式，请按照以下步骤操作：

. 选择是否要突出显示大于 (>) 或小于 (<) 阈值的值。在这个例子中，我们将突出显示大于（>）阈值水平的值。
. 为“警告”阈值选择一个值。当小部件显示大于此级别的值时，它会以橙色显示仪表。
. 为“关键”阈值选择一个值。大于此水平的值将导致仪表显示为红色。


您可以选择仪表的最小值和最大值。低于最小值的值将不会显示仪表。高于最大值的值将显示满量表。如果您未选择最小值或最大值，小部件将根据小部件的值选择最佳最小值和最大值。

image:Gauge-Solid.png["实心/传统规格，宽度=374"] image:Gauge-Bullet.png["子弹规格，宽度=374"]



== 格式化单值小部件

在单值小部件中，除了设置警告（橙色）和临界（红色）阈值外，您还可以选择以绿色或白色背景显示“范围内”值（低于警告级别的值）。

image:Single-ValueWidgets.png["带格式和不带格式的单值小部件"]

单击单值小部件或仪表小部件中的链接将显示与小部件中第一个查询相对应的查询页面。



== 格式化表格小部件

与单值和仪表小部件一样，您可以在表格小部件中设置条件格式，从而可以使用颜色和/或特殊图标突出显示数据。

条件格式允许您在表格小部件中设置和突出显示警告级别和临界级别阈值，从而可以立即看到异常值和异常数据点。

image:ConditionalFormattingExample.png["条件格式示例"]

表中的每一列均单独设置条件格式。例如，您可以为容量列选择一组阈值，为吞吐量列选择另一组阈值。

如果更改某一列的单位显示，条件格式将保留并反映值的变化。尽管显示单位不同，下面的图像显示相同的条件格式。

image:ConditionalFormatting_GiB.png["条件格式 - GiB"] image:ConditionalFormatting_TiB.png["条件格式 - TiB"]

您可以选择将条件格式显示为颜色、图标或两者。



== 选择显示数据的单位

仪表板上的大多数小部件允许您指定显示值的单位，例如_兆字节_、_千_、_百分比_、_毫秒 (ms)_ 等。在许多情况下，Data Infrastructure Insights知道所获取数据的最佳格式。在不知道最佳格式的情况下，您可以设置所需的格式。

在下面的折线图示例中，已知为小部件选择的数据以_字节_（基本 IEC 数据单位：参见下表）为单位，因此基本单位自动选择为“字节 (B)”。但是，数据值足够大，可以表示为吉比字节 (GiB)，因此Data Infrastructure Insights将值自动格式化为 GiB。图表上的 Y 轴以“GiB”为显示单位，所有值均以该单位显示。

image:used_memory_in_bytes.png["基本单位字节（以千兆字节为单位），宽度=640"]

如果您想以不同的单位显示图表，您可以选择另一种格式来显示值。由于此示例中的基本单位是_字节_，因此您可以从支持的“基于字节”的格式中进行选择：位 (b)、字节 (B)、千比字节 (KiB)、兆比字节 (MiB)、吉比字节 (GiB)。  Y 轴标签和值根据您选择的格式而变化。

image:used_memory_in_bytes_gb.png["选择显示单位，宽度=640"]

如果不知道基本单位，则可以从link:#available-units["可用单位"]，或者输入您自己的。一旦分配了基本单位，您就可以选择以适当的支持格式之一显示数据。

image:bits_per_second.png["选择您自己的基本单位，宽度=320"]

要清除设置并重新开始，请单击“*重置默认值*”。



=== 关于自动套用格式

大多数指标都是由数据收集器以最小单位报告的，例如整数 1,234,567,890 字节。默认情况下，Data Infrastructure Insights将自动格式化该值以实现最易读的显示。例如，1,234,567,890 字节的数据值将自动格式化为 1.23 _Gibibytes_。您可以选择以其他格式显示它，例如_Mebibytes_。该值将相应显示。


NOTE: Data Infrastructure Insights使用美式英语数字命名标准。美国的“billion”相当于“chill million”。



=== 具有多个查询的小部件

如果您有一个时间序列小部件（即线、样条线、区域、堆叠区域），其中有两个查询，并且都绘制了主 Y 轴，则基本单位不会显示在 Y 轴的顶部。但是，如果您的小部件在主 Y 轴上有一个查询，在辅助 Y 轴上也有一个查询，则会显示每个查询的基本单位。

image:UnitsOnPrimaryAndSecondaryYAxis.png["两个 Y 轴上的单位"]

如果您的小部件有三个或更多查询，则基本单位不会显示在 Y 轴上。



=== 可用单位

下表按类别显示了所有可用的单位。

|===


| *类别* | *单位* 


| 货币 | 美分 


| 数据（IEC） | 位 字节 千比字节 兆比字节 吉比字节 太比字节 皮比字节 艾比字节 


| 数据速率（IEC） | 比特/秒 字节/秒 千比字节/秒 兆比字节/秒 吉比字节/秒 太比字节/秒 皮比字节/秒 


| 数据（公制） | 千字节 兆字节 千兆字节 太字节 拍字节 艾字节 


| 数据速率（公制） | 千字节/秒 兆字节/秒 千兆字节/秒 太字节/秒 拍字节/秒 艾字节/秒 


| 国际电工委员会 | kibi mebi gibi tebi pebi exbi 


| 十进制 | 整数千百万十亿万亿 


| 百分比 | 百分比 


| 时间 | 纳秒 微秒 毫秒 秒 分钟 小时 


| 温度 | 摄氏度华氏度 


| 频率 | 赫兹 千赫兹 兆赫兹 千兆赫兹 


| CPU | 纳米核心 微核心 毫核心 千核心 兆核心 千兆核心 teracores petacores exacores 


| 吞吐量 | I/O 操作数/秒 操作数/秒 请求数/秒 读取数/秒 写入数/秒 操作数/分钟 读取数/分钟 写入数/分钟 
|===


== 电视模式和自动刷新

仪表板和资产登陆页面上的小部件中的数据根据所选仪表板时间范围确定的刷新间隔自动刷新。刷新间隔取决于小部件是时间序列（线、样条线、面积、堆积面积图）还是非时间序列（所有其他图表）。

|===


| 仪表板时间范围 | 时间序列刷新间隔 | 非时间序列刷新间隔 


| 最后15分钟 | 10秒 | 1分钟 


| 最后30分钟 | 15秒 | 1分钟 


| 最后60分钟 | 15秒 | 1分钟 


| 过去 2 小时 | 30秒 | 5分钟 


| 过去 3 小时 | 30秒 | 5分钟 


| 过去 6 小时 | 1分钟 | 5分钟 


| 过去 12 小时 | 5分钟 | 10 分钟 


| 过去 24 小时 | 5分钟 | 10 分钟 


| 过去 2 天 | 10 分钟 | 10 分钟 


| 过去 3 天 | 15 分钟 | 15 分钟 


| 过去 7 天 | 1 小时 | 1 小时 


| 过去 30 天 | 2 小时 | 2 小时 
|===
每个小部件在其右上角显示其自动刷新间隔。

自定义仪表板时间范围不提供自动刷新功能。

与*电视模式*结合使用时，自动刷新功能可以在仪表板或资产页面上近乎实时地显示数据。电视模式提供整洁的显示；导航菜单被隐藏，为您的数据显示提供了更多的屏幕空间，编辑按钮也是如此。电视模式忽略典型的Data Infrastructure Insights超时，使显示保持实时状态，直到手动或通过授权安全协议自动注销。


NOTE: 由于NetApp Console自己的用户登录超时时间为 7 天，因此Data Infrastructure Insights也必须在该事件发生时注销。您只需再次登录，您的仪表板将继续显示。

* 要激活电视模式，请单击电视模式按钮。
* 要禁用电视模式，请单击屏幕左上角的“退出”按钮。


您可以通过点击右上角的暂停按钮暂时停止自动刷新。暂停时，仪表板时间范围字段将显示暂停数据的活动时间范围。自动刷新暂停时，您的数据仍在被获取和更新。单击“恢复”按钮继续自动刷新数据。

image:AutoRefreshPaused.png["自动刷新已暂停"]



== 仪表板组

通过分组，您可以查看和管理相关的仪表板。例如，您可以拥有一个专用于租户存储的仪表板组。仪表板组在“仪表板”>“显示所有仪表板”页面上进行管理。

image:DashboardGroupNoPin.png["仪表板分组"]

默认显示两个组：

* *所有仪表板*列出了所有已创建的仪表板，无论所有者是谁。
* *我的仪表板*仅列出当前用户创建的仪表板。


每个组中包含的仪表板数量显示在组名旁边。

要创建新组，请单击“+”创建新仪表板组按钮。输入组的名称，然后单击“创建组”。将以该名称创建一个空组。

要将仪表板添加到组，请单击“所有仪表板”组以显示租户上的所有仪表板，或者如果只想查看您拥有的仪表板，请单击“我的仪表板”，然后执行以下操作之一：

* 要添加单个仪表板，请单击仪表板右侧的菜单并选择“添加到组”。
* 要将多个仪表板添加到一个组，请单击每个仪表板旁边的复选框来选择它们，然后单击“批量操作”按钮并选择“添加到组”。


通过选择“从组中删除”以相同方式从当前组中删除仪表板。您不能从“所有仪表板”或“我的仪表板”组中删除仪表板。


NOTE: 从组中删除仪表板并不会从Data Infrastructure Insights中删除该仪表板。要完全删除仪表板，请选择仪表板并单击“删除”。这会将其从其所属的任何组中删除，并且任何用户都无法再使用它。



== 固定您最喜欢的仪表板

您可以通过将喜爱的仪表板固定到仪表板列表顶部来进一步管理仪表板。要固定仪表板，只需单击将鼠标悬停在任何列表中的仪表板上时显示的图钉按钮即可。

仪表板固定/取消固定是个人用户的偏好，与仪表板所属的组（或多个组）无关。

image:DashboardPin.png["固定仪表板"]



== 黑暗主题

您可以选择使用浅色主题（默认）来显示Data Infrastructure Insights，该主题使用浅色背景和深色文本显示大多数屏幕，或者使用深色主题（使用深色背景和浅色文本显示大多数屏幕）。

要在明暗主题之间切换，请单击屏幕右上角的用户名按钮并选择所需的主题。

image:DarkThemeSwitch.png["在明暗主题之间切换"]

深色主题仪表板视图：image:DarkThemeDashboardExample.png["深色主题仪表板示例"]

浅色主题仪表板视图：image:LightThemeDashboardExample.png["浅色主题仪表板示例"]


NOTE: 某些屏幕区域（例如某些小部件图表）即使在深色主题下查看仍会显示浅色背景。



== 折线图插值

不同的数据收集器通常以不同的间隔轮询其数据。例如，数据收集器 A 可能每 15 分钟轮询一次，而数据收集器 B 可能每 5 分钟轮询一次。当折线图窗口小部件（也包括样条曲线、面积图和堆积面积图）将来自多个数据收集器的数据聚合到一条线中（例如，当窗口小部件按“全部”分组时），并每五分钟刷新一次线时，来自收集器 B 的数据可能会准确显示，而来自收集器 A 的数据可能会有间隙，从而影响聚合，直到收集器 A 再次轮询。

为了缓解这种情况，Data Infrastructure Insights在聚合时插入数据，使用周围的数据点对数据进行“最佳猜测”，直到数据收集器再次轮询。您始终可以通过调整小部件的分组来单独查看每个数据收集器的对象数据。



=== 插值方法

创建或修改折线图（或样条图、面积图或堆积面积图）时，可以将插值方法设置为三种类型之一。在“分组依据”部分中，选择所需的插值。

image:Interpolation_Methods.png["小部件编辑器的分组部分显示了三种插值方法"]

* *无*：不执行任何操作，即不在中间生成点。


image:Interpolation_None.png["简单的直角线，表示数据点之间没有插值"]

* *楼梯*：一个点由前一个点的值生成。在直线上，这将显示为典型的“楼梯”布局。


image:Interpolation_Stair.png["显示阶梯插值的简单直线"]

* *线性*：生成一个点作为连接两点之间的值。生成一条看起来像连接两点的线，但带有额外的（插值的）数据点。


image:Interpolation_Linear.png["简单的直线显示线性插值，每个原始点之间都有附加数据点"]



=== 线部件中的异常界限

当在仪表板或登录页面上包含折线图或样条图小部件时，您可以选择在数据的*预期边界*上下文中查看图表。您可以将其视为寻找数据模式中的异常。

DII 使用季节性数据（每小时或每天）来设定在给定时间内数据下降的预期上限和下限。如果数据高于或低于预期界限，图表将会突出显示为异常。

image:expected_bounds_example_showing_spike.png["异常边界示例 - 显示实际数据峰值高于预期边界，宽度=600"]

要查看异常边界，请编辑小部件并选择“显示异常边界”。您可以从两种检测算法中进行选择：

* *自适应探测器*能够快速适应变化，有助于进行详细调查。
* *平滑检测器* 最大限度地减少噪音和误报，滤除短期波动，同时仍能检测到显著的变化。


此外，您可以选择显示“每小时”或“每日”季节性，以及设置检测的敏感度。  _高_灵敏度检测到更多的边界跨越，_低_灵敏度检测到的边界跨越较少。

image:expected_bounds_settings.png["异常边界的设置，包括检测算法、季节性和敏感度"]

请记住，当图表设置为显示单线时，您可能只能查看预期边界。如果您的分组依据设置或过滤器显示多行，或者您为小部件设置了多个查询，则显示预期边界的选项将被禁用。
