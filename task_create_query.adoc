---
sidebar: sidebar 
permalink: task_create_query.html 
summary: 查询允许您快速轻松地识别感兴趣的资产和指标。 
keywords: query, queries 
---
= 创建查询
:hardbreaks:
:allow-uri-read: 


[role="lead"]
通过查询，您可以在粒度级别搜索租户上的资产，从而可以筛选所需的数据并根据您的喜好对结果进行排序。

例如，您可以为_volumes_创建一个查询，添加一个过滤器来查找与所选卷关联的特定_storages_，添加另一个过滤器来查找所选存储上的特定_annotation_（例如“Tier 1”），最后添加另一个过滤器来查找所有_IOPS - 读取（IO/s）_大于 25 的存储。当显示结果时，您可以按升序或降序对与查询相关的信息列进行排序。

注意：当添加了获取资产的新数据收集器，或者进行了任何注释或应用程序分配时，只有在对查询进行索引后，您才能查询这些新资产、注释或应用程序。索引会按照定期安排的时间间隔或在某些事件（例如运行注释规则）期间发生。

.创建查询非常简单：
. 导航到*查询>*+新查询*。
. 从“选择...”列表中，选择要查询的对象类型。您可以滚动浏览列表，也可以开始输入以更快地找到要搜索的内容。


.滚动列表：
image:QueryDrop-DownList.png["查询下拉菜单"]

.输入搜索：
image:QueryPageFilter.png["键入以查找"]

您可以通过单击“Filter By”字段中的“*+*”按钮来添加过滤器，以进一步缩小查询范围。按对象或属性对行进行分组。使用集成数据（Kubernetes、 ONTAP Advanced Metrics 等）时，如果需要，您可以按多个属性进行分组。

image:QueryFilterExample.png["查询过滤和分组"]

查询结果列表显示许多默认列，具体取决于搜索的对象类型。要添加、删除或更改列，请单击表格右侧的齿轮图标。可用的列根据资产/指标类型而有所不同。

image:QuerySelectColumns.png["选择列"]



== 观看实际操作

link:https://media.netapp.com/video-detail/d0530e0b-a222-52e7-92b1-dbeeee41b712/explore-and-analyze-with-queries-in-data-infrastructure-insights["使用Data Infrastructure Insights中的查询进行探索和分析（视频）"]



== 选择聚合、单位、条件格式



=== 聚合和单位

对于“值”列，您可以通过选择显示值的聚合方式以及选择显示这些值的单位来进一步优化查询结果。通过选择列顶角的“三个点”菜单可以找到这些选项。

image:Query_Page_Aggregation_etc.png["查询页面结果显示聚合、条件格式、单位显示和列重命名"]



==== 单位

您可以选择显示值的单位。例如，如果选定的列显示原始容量，并且值以 GiB 显示，但您希望将其显示为 TiB，只需从单位显示下拉菜单中选择 TiB。



==== 聚合

同样，如果显示的值是从基础数据聚合而来的“平均值”，但您希望显示所有值的总和，请从“分组依据”下拉菜单中选择“总和”（如果您希望任何分组值显示总和）或从“时间聚合依据”下拉菜单中选择“总和”（如果您希望行值显示基础数据的总和）。

您可以选择通过“平均值”、“最大值”、“最小值”或“总和”来聚合分组数据点。

您可以按“平均值”、“最后获取的数据点”、“最大值”、“最小值”或“总和”来聚合单个行的数据。



==== 条件格式

条件格式允许您在查询结果列表中突出显示警告级别和临界级别阈值，从而立即显示异常值和异常数据点。

image:Query_Page_Conditional_Formatting.png["查询页面上的条件格式"]

为每一列单独设置条件格式。例如，您可以为容量列选择一组阈值，为吞吐量列选择另一组阈值。



==== 重命名列

重命名列会改变查询结果列表中显示的名称。如果将查询列表导出为 .CSV，新的列名也会显示在结果文件中。



=== 保存

配置查询以显示您想要的结果后，您可以单击“保存”按钮保存查询以供将来使用。给它一个有意义且独特的名字。



== 有关过滤的更多信息



=== 通配符和表达式

当您在查询或仪表板小部件中过滤文本或列表值时，当您开始输入时，系统会向您显示基于当前文本创建*通配符过滤器*的选项。选择此选项将返回与通配符表达式匹配的所有结果。您还可以使用 NOT 或 OR 创建*表达式*，或者您可以选择“无”选项来过滤字段中的空值。

image:Type-Ahead-Example-ingest.png["通配符过滤器"]

基于通配符或表达式的过滤器（例如 NOT、OR、“无”等）在过滤器字段中以深蓝色显示。您直接从列表中选择的项目显示为浅蓝色。

image:Type-Ahead-Example-Wildcard-DirectSelect.png["通配符过滤结果"]

请注意，通配符和表达式过滤适用于文本或列表，但不适用于数字、日期或布尔值。



=== 精炼过滤器

您可以使用以下内容来优化过滤器：

|===


| 筛选器 | 它的作用 | 示例 | 结果 


| *（星号） | 让您搜索一切 | 沃尔*雷尔 | 返回以“vol”开头并以“rhel”结尾的所有资源 


| ? （问号） | 使您能够搜索特定数量的字符 | BOS-PRD??-S12 | 返回 BOS-PRD**__12__**-S12、BOS-PRD**__23__**-S12 等等 


| 或 | 使您能够指定多个实体 | FAS2240 或 CX600 或 FAS3270 | 返回 FAS2440、CX600 或 FAS3270 中的任意一个 


| 不是 | 允许您从搜索结果中排除文本 | 非 EMC* | 返回所有不以“EMC”开头的内容 


| _没有任何_ | 在所有字段中搜索 NULL 值 | _没有任何_ | 返回目标字段为空的结果 


| 不是 * | 在纯文本字段中搜索 NULL 值 | 不是 * | 返回目标字段为空的结果 
|===
如果将过滤字符串括在双引号中，Insight 会将第一个引号和最后一个引号之间的所有内容视为完全匹配。引号内的任何特殊字符或运算符都将被视为文字。例如，过滤“*”将返回文字星号的结果；在这种情况下，星号不会被视为通配符。当运算符 OR 和 NOT 括在双引号中时，它们也将被视为文字字符串。



=== 过滤布尔值

当过滤布尔值时，您可能会看到以下过滤选项：

* *任何*：这将返回所有结果，包括设置为“是”、“否”或根本没有设置的结果。
* *是*：仅返回“是”的结果。请注意，DII 在大多数表格中均显示“是”作为复选标记。值可以设置为“True”、“On”等；DII 将所有这些都视为“是”。
* *否*：仅返回“否”结果。请注意，DII 在大多数表格中将“否”显示为“X”。值可以设置为“False”、“Off”等；DII 将所有这些都视为“No”。
* *无*：仅返回根本没有设置值的结果。也称为“空”值。




== 现在我有了查询结果，我该做什么？

查询提供了一个简单的地方来添加注释或将应用程序分配给资产。请注意，您只能将应用程序或注释分配给您的库存资产（磁盘、存储等）。集成指标不能承担注释或应用程序分配。

要为查询得到的资产分配注释或应用程序，只需使用结果表左侧的复选框列选择资产，然后单击右侧的*批量操作*按钮。选择要应用于选定资产的所需操作。

image:QueryVolumeBulkActions.png["查询批量操作示例"]



== 注释规则需要查询

如果您正在配置link:task_create_annotation_rules.html["标注规则"]，每个规则都必须有一个可以使用的底层查询。但正如您上面所看到的，查询可以根据需要进行广泛或狭窄的查询。
