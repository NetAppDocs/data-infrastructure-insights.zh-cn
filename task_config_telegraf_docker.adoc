---
sidebar: sidebar 
permalink: task_config_telegraf_docker.html 
keywords: telegraf, installation, install, docker 
summary: Docker 数据收集器配置 
---
= Docker 数据收集器
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Data Infrastructure Insights使用此数据收集器从 Docker 收集指标。



== 安装

. 从*可观察性 > 收集器*中，单击*+数据收集器*。选择 Docker。
+
如果您尚未配置用于收集的代理，系统会提示您link:task_config_telegraf_agent.html["安装代理"]您的租户。

+
如果您已经配置了代理，请选择适当的操作系统或平台，然后单击“继续”。

. 按照 Docker 配置屏幕中的说明配置数据收集器。说明根据您用于收集数据的操作系统或平台的类型而有所不同。


image:DockerDCConfigLinux.png["Docker 配置"]



== 设置

Docker 的 Telegraf 输入插件通过指定的 UNIX 套接字或 TCP 端点收集指标。



=== 兼容性

配置是针对 Docker 版本 1.12.6 开发的。



=== 设置



=== 通过 UNIX 套接字访问 Docker

如果 Telegraf 代理在裸机上运行，请通过运行以下命令将 telegraf Unix 用户添加到 docker Unix 组：

 sudo usermod -aG docker telegraf
如果 Telegraf 代理在 Kubernetes pod 中运行，则通过将套接字作为卷映射到 pod 中，然后将该卷挂载到 /var/run/docker.sock 来公开 Docker Unix 套接字。例如，将以下内容添加到 PodSpec：

[listing]
----
volumes:
...
- name: docker-sock
hostPath:
path: /var/run/docker.sock
type: File
----
然后，将以下内容添加到容器中：

[listing]
----
volumeMounts:
...
- name: docker-sock
mountPath: /var/run/docker.sock
----
请注意，为 Kubernetes 平台提供的Data Infrastructure Insights安装程序会自动处理此映射。



=== 通过 TCP 端点访问 Docker

默认情况下，Docker 使用端口 2375 进行未加密访问，使用端口 2376 进行加密访问。



== 物体和计数器

收集以下对象及其计数器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 目的： | 标识符： | 属性： | 数据点： 


| Docker 引擎 | 命名空间 Docker 引擎 | 节点名称 节点IP 节点UUID 节点OS Kubernetes集群 Docker版本 单元 | 内存容器 已暂停的容器 正在运行的容器 已停止的容器 CPU Go 例程 图像 侦听器事件 已使用的文件描述符 可用数据 已使用的数据总量 可用元数据 元数据 已使用的总元数据 池 块大小 


| Docker容器 | 命名空间容器名称 Docker 引擎 | Kubernetes 容器哈希 Kubernetes 容器端口 Kubernetes 容器重启计数 Kubernetes 容器终止消息路径 Kubernetes 容器终止消息策略 Kubernetes Pod 终止宽限期 容器镜像 容器状态 容器版本 节点名称 Kubernetes 容器日志路径 Kubernetes 容器名称 Kubernetes Docker 类型 Kubernetes Pod 名称 Kubernetes Pod 命名空间 Kubernetes Pod UID Kubernetes 沙盒 ID 节点 IP 节点 UUID Docker 版本 Kubernetes IO 配置可见 Kubernetes IO 配置源 OpenShift IO SCC Kubernetes 描述 Kubernetes 显示名称 OpenShift 标签 Kompose 服务 Pod 模板哈希 控制器修订哈希 Pod 模板生成 许可证架构 构建日期 架构 许可证架构名称 架构 URL 架构 VCS URL 架构 供应商架构 版本 架构 架构版本维护者 客户 Pod Kubernetes StatefulSet Pod 名称 租户 Web 控制台 架构 权威来源 URL 构建日期 RH 构建主机 RH 组件分布范围 安装发布运行摘要 卸载 VCS 引用 VCS 类型 供应商版本 健康状况 容器 ID | 内存活动匿名内存活动文件内存缓存内存层次限制内存非活动匿名内存非活动文件内存限制内存映射文件内存最大使用量内存页面错误内存页面严重错误内存分页传入内存分页传出内存驻留集大小内存驻留集大小巨大内存总活动匿名内存总活动文件内存总缓存内存总非活动匿名内存总非活动文件内存总映射文件内存总页面错误内存总页面严重错误内存总分页传入内存总分页传出内存总驻留集大小内存总驻留集大小巨大内存总不可清除内存不可清除内存使用情况内存使用率退出代码 OOM 终止 PID 启动于失败连胜 


| Docker 容器块 IO | 命名空间容器名称设备Docker引擎 | Kubernetes 容器哈希 Kubernetes 容器端口 Kubernetes 容器重启计数 Kubernetes 容器终止消息路径 Kubernetes 容器终止消息策略 Kubernetes Pod 终止宽限期 容器镜像 容器状态 容器版本 节点名称 Kubernetes 容器日志路径 Kubernetes 容器名称 Kubernetes Docker 类型 Kubernetes Pod 名称 Kubernetes Pod 命名空间 Kubernetes Pod UID Kubernetes 沙盒 ID 节点 IP 节点 UUID Docker 版本 Kubernetes 配置可见 Kubernetes 配置源 OpenShift SCC Kubernetes 描述 Kubernetes 显示名称 OpenShift 标签 架构 架构版本 Pod 模板哈希 控制器修订哈希 Pod 模板生成 Kompose 服务架构 构建日期 架构许可证 架构名称 架构供应商 客户 Pod Kubernetes StatefulSet Pod 名称 租户 Web 控制台 构建日期 许可证供应商 架构 权威来源 URL RH 构建主机 RH 组件分布范围 安装 维护者 发布 运行摘要 卸载 VCS 引用 VCS 类型 版本 架构 URL 架构 VCS URL 架构版本 容器 ID | IO 服务字节数 递归异步 IO 服务字节数 递归读取 IO 服务字节数 递归同步 IO 服务字节数 递归总计 IO 服务字节数 递归写入 IO 服务 递归异步 IO 服务 递归读取 IO 服务 递归同步 IO 服务 递归总计 IO 服务 递归写入 


| Docker容器网络 | 命名空间容器名称网络Docker引擎 | 容器镜像 容器状态 容器版本 节点名称 节点IP 节点UUID 节点OS K8s集群 Docker版本 容器ID | RX 丢弃 RX 字节数 RX 错误数 RX 数据包数 TX 丢弃 TX 字节数 TX 错误数 TX 数据包数 


| Docker 容器 CPU | 命名空间容器名称CPU Docker引擎 | Kubernetes 容器哈希 Kubernetes 容器端口 Kubernetes 容器重启计数 Kubernetes 容器终止消息路径 Kubernetes 容器终止消息策略 Kubernetes Pod 终止宽限期 Kubernetes 配置可见 Kubernetes 配置源 OpenShift SCC 容器镜像 容器状态 容器版本 节点名称 Kubernetes 容器日志路径 Kubernetes 容器名称 Kubernetes Docker 类型 Kubernetes Pod 名称 Kubernetes Pod 命名空间 Kubernetes Pod UID Kubernetes 沙盒 ID 节点 IP 节点 UUID 节点操作系统 Kubernetes 集群 Docker 版本 Kubernetes 描述 Kubernetes 显示名称 OpenShift 标签 架构版本 Pod 模板哈希 控制器修订哈希 Pod 模板生成 Kompose 服务架构构建日期 架构许可证 架构名称 架构供应商客户 Pod Kubernetes StatefulSet Pod 名称租户 Web 控制台构建日期 许可证供应商架构权威来源 URL RH 构建主机 RH 组件分布范围安装维护者发布运行摘要卸载 VCS 引用 VCS 类型版本架构 URL 架构 VCS URL 架构版本容器 ID | 限制周期限制限制周期限制限制时间内核模式使用率用户模式使用率使用率百分比系统使用率总计 
|===


== 故障排除

[cols="2*"]
|===
| 问题： | 尝试一下： 


| 按照配置页面上的说明操作后，我没有在Data Infrastructure Insights中看到我的 Docker 指标。 | 检查 Telegraf 代理日志，看它是否报告以下错误：E！插件 [inputs.docker] 中的错误：尝试连接到 Docker 守护程序套接字时权限被拒绝如果确实如此，请采取必要的步骤，以便按照上面指定的方式为 Telegraf 代理提供对 Docker Unix 套接字的访问权限。 
|===
更多信息可从link:concept_requesting_support.html["支持"]页。
