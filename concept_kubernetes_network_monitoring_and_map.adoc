---
sidebar: sidebar 
permalink: concept_kubernetes_network_monitoring_and_map.html 
keywords: service map, workloads, 
summary: 介绍 Kubernetes 工作负载依赖关系和流程，并重点介绍网络和性能问题 
---
= Kubernetes 网络性能监控和映射
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Kubernetes 网络性能监控和映射功能通过映射服务（也称为工作负载）之间的依赖关系来简化故障排除，并提供对网络性能延迟和异常的实时可见性，以便在性能问题影响用户之前识别它们。此功能通过分析和审核 Kubernetes 流量流帮助组织降低总体成本。

主要特点：• 工作负载图显示 Kubernetes 工作负载依赖关系和流程，并突出显示网络和性能问题。  • 监控 Kubernetes pod、工作负载和节点之间的网络流量；识别流量和延迟问题的来源。  • 通过分析入口、出口、跨区域和跨区域网络流量来降低总体成本。

image:workload-map-animated.gif["工作负载图示例"]



== 先决条件

在使用 Kubernetes 网络性能监控和映射之前，您必须先配置link:task_config_telegraf_agent_k8s.html["NetApp Kubernetes 监控操作员"]启用此选项。在部署操作员期间，选择“网络性能和地图”复选框以启用。您还可以通过导航到 Kubernetes 登录页面并选择“修改部署”来启用此选项。

image:ServiceMap_NKMO_Deployment_Options.png["在 NKMO 停止期间选择地图选项"]



== 监视器

工作负载图使用link:task_create_monitor.html["监视器"]来获取信息。Data Infrastructure Insights提供了许多默认的 Kubernetes 监视器（请注意，这些监视器默认情况下可能处于_暂停_状态。您可以_恢复_（即启用）您想要的监视器），或者您可以为 kubernetes 对象创建自定义监视器，工作负载图也将使用这些监视器。

您可以针对以下任何对象类型创建Data Infrastructure Insights指标警报。确保数据按默认对象类型分组。

* kubernetes.工作负载
* kubernetes.daemonset
* kubernetes.deployment
* kubernetes.cronjob
* kubernetes.job
* kubernetes.replicaset
* kubernetes.statefulset
* Kubernetes Pod
* kubernetes.network_traffic_l4




== 地图

地图显示服务/工作负载及其相互关系。箭头显示交通方向。将鼠标悬停在工作负载上会显示该工作负载的摘要信息，如下例所示：

image:ServiceMap_Simple_Example.png["工作负载图工作负载示例"]

圆圈内的图标代表不同的服务类型。请注意，仅当底层对象具有<<workload-labels,标签>>。

image:ServiceMap_Icons.png["服务图标说明"]

每个圆圈的大小表示节点大小。请注意，这些尺寸是相对的，您的浏览器缩放级别或屏幕尺寸可能会影响实际的圆圈尺寸。同样，流量线样式可让您一目了然地了解连接大小；粗实线表示高流量，而浅虚线表示低流量。

圆圈内的数字是服务当前正在处理的外部连接数。

image:ServiceMap_Node_and_Connection_Legend.png["图例显示了相对圆（节点）和连接尺寸"]



== 工作负载详情和警报

彩色圆圈表示工作负载的警告或严重级别警报。将鼠标悬停在圆圈上可查看问题摘要，或单击圆圈可打开包含更多详细信息的滑出面板。

image:Workload_Map_Slideout_with_Alert.png["带有警报的工作负载滑出详细信息"]



== 查找和过滤

与其他Data Infrastructure Insights功能一样，您可以轻松设置过滤器以关注您想要的特定对象或工作负载属性。

image:Workload_Map_Filtering.png["工作负载图过滤"]

同样，在“查找”字段中输入字符串将突出显示匹配的工作负载。

image:Workload_Map_Find_Highlighting.png["在查找框中输入突出显示工作量"]



== 工作负载标签

如果您希望地图识别所显示的工作负载类型（即圆圈图标），则工作负载标签是必需的。标签的得出方式如下：

* 通用术语中运行的服务/应用程序的名称
* 如果源是 pod：
+
** 标签源自 pod 的工作负载标签
** 工作负载上的预期标签：app.kubernetes.io/component
** 标签名称参考： https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels/[]
** 推荐标签：
+
*** 前端
*** 后端
*** 数据库
*** 缓存
*** 队列
*** 卡夫卡




* 如果源位于 Kubernetes 集群外部：
+
** Data Infrastructure Insights将尝试解析 DNS 解析名称以提取服务类型。
+
例如，DNS 解析名称为 _s3.eu-north-1.amazonaws.com_，解析名称将被解析为 _s3_ 作为服务类型。







== 深入探索

右键单击工作负载会显示更多选项以供进一步探索。例如，您可以从这里放大查看该工作负载的连接。

image:Workload_Map_Zoom_Into_Connections.png["工作负载图右键单击缩放以显示工作负载的连接"]

或者您可以打开详细信息滑出面板直接查看_摘要_、_网络_或_Pod & Storage_选项卡。

image:Workload_Map_Detail_Network_Slideout.png["详细滑出网络选项卡示例"]

最后，选择“转到资产页面”将打开工作负载的详细资产登录页面。

image:Workload_Map_Asset_Page.png["工作负载资产页面"]
