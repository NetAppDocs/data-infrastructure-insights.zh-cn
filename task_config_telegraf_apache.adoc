---
sidebar: sidebar 
permalink: task_config_telegraf_apache.html 
keywords: telegraf, installation, install, apache 
summary: Apache 数据收集器配置 
---
= Apache 数据收集器
:hardbreaks:
:allow-uri-read: 


[role="lead"]
该数据收集器允许从租户上的 Apache 服务器收集数据。

.先决条件
* 您必须设置并正确运行 Apache HTTP 服务器
* 您必须在代理主机/虚拟机上拥有 sudo 或管理员权限
* 通常，Apache _mod_status_ 模块配置为在 Apache 服务器的“/server-status?auto”位置显示一个页面。必须启用_ExtendedStatus_选项才能收集所有可用字段。有关如何配置服务器的信息，请参阅 Apache 模块文档： https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable[]




== 安装

. 从*可观察性 > 收集器*中，单击*+数据收集器*。选择 Apache。
+
选择安装 Telegraf 代理的操作系统或平台。

. 如果您尚未安装用于收集的代理，或者您希望为不同的操作系统或平台安装代理，请单击“显示说明”以展开link:task_config_telegraf_agent.html["代理安装"]指示。
. 选择用于此数据收集器的代理访问密钥。您可以通过单击 *+ 代理访问密钥* 按钮添加新的代理访问密钥。最佳实践：仅当您想要对数据收集器进行分组（例如按操作系统/平台）时才使用不同的代理访问密钥。
. 按照配置步骤配置数据收集器。说明根据您用于收集数据的操作系统或平台的类型而有所不同。


image:ApacheDCConfigLinux.png["Apache 配置"]



== 设置

Telegraf 的 Apache HTTP 服务器插件依赖于“mod_status”模块的启用。启用此功能后，Apache 的 HTTP 服务器将公开一个 HTML 端点，您可以在浏览器上查看该端点，也可以抓取该端点以提取所有 Apache 的 HTTP 服务器配置的状态。



=== 兼容性：

配置是针对 Apache 的 HTTP 服务器版本 2.4.38 开发的。



=== 启用 mod_status：

启用和公开“mod_status”模块涉及两个步骤：

* 启用模块
* 从模块中公开统计数据




=== 启用模块：

模块的加载由“/usr/local/apache/conf/httpd.conf”下的配置文件控制。编辑配置文件并取消注释以下行：

 LoadModule status_module modules/mod_status.so
 Include conf/extra/httpd-info.conf


=== 从模块公开统计数据：

'mod_status' 的公开由 '/usr/local/apache2/conf/extra/httpd-info.conf' 下的配置文件控制。确保该配置文件中包含以下内容（至少其他指令也会存在）：

[listing]
----
# Allow server status reports generated by mod_status,
# with the URL of http://servername/server-status
<Location /server-status>
    SetHandler server-status
</Location>

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
ExtendedStatus On
----
有关“mod_status”模块的详细说明，请参阅link:https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable["Apache 文档"]



== 物体和计数器

收集以下对象及其计数器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 目的： | 标识符： | 属性： | 数据点： 


| 阿帕奇 | 命名空间服务器 | 节点 IP 节点名称 端口 父服务器配置生成 父服务器 MPM 生成服务器正常运行时间正在停止 | 繁忙工作者 每个请求的字节数 每秒字节数 CPU 子进程 系统 CPU 子进程 用户 CPU 负载 CPU 系统 CPU 用户 异步连接 关闭异步连接 保持活动异步连接 写入连接 每个请求的总持续时间 空闲工作者 平均负载（最近 1 分钟） 平均负载（最近 15 分钟） 平均负载（最近 5 分钟） 进程 每秒请求数 总访问数 总持续时间 总千字节数 记分板 关闭记分板 DNS 查找记分板 完成记分板 空闲清理记分板 保持活动记分板 记录记分板 打开记分板 读取记分板 发送记分板 启动记分板 等待 
|===


== 故障排除

更多信息可从link:concept_requesting_support.html["支持"]页。
